<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
    <Package
        Name="Portal"
        Manufacturer="Ruben Schmidmeister"
        Version="0.1.7"
        UpgradeCode="dd827eb7-1309-4d4e-9eea-50022cb17bad"
        Scope="perUserOrMachine">
        <MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeError)" />

        <Media Id="1" Cabinet="myapplication.cab" EmbedCab="yes" />

        <Property Id="ApplicationFolderName" Value="Portal" />

        <!-- Installer Icon -->
        <Icon Id="icon.ico" SourceFile="..\icon.ico"/>
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />

        <!-- Sets the default installation folder -->
        <StandardDirectory Id="ProgramFiles6432Folder">
            <Directory Id="INSTALLFOLDER" Name="!(bind.Property.ProductName)" />
        </StandardDirectory>

         <!-- Shows a UI that allows customizing the install location -->
        <ui:WixUI Id="WixUI_CustomInstallDir" InstallDirectory="INSTALLFOLDER" />

        <Feature Id="Main">
            <ComponentGroupRef Id="MainComponent" />
            <ComponentRef Id="StartMenuShortcut" />
        </Feature>

        <!-- Installs the actual files -->
        <ComponentGroup Id="MainComponent" Directory="INSTALLFOLDER">
            <Component>
                <File Id="portal.exe" Source="..\..\..\target\release\portal.exe" Vital="true" />
            </Component>
        </ComponentGroup>

        <!-- Start menu shortcut -->
        <!-- Source: https://wixtoolset.org/docs/v3/howtos/files_and_registry/create_start_menu_shortcut/ -->
        <StandardDirectory Id="ProgramMenuFolder">
            <Component Id="StartMenuShortcut" Guid="*">
                <Shortcut Id="ApplicationStartMenuShortcut" Name="Portal" Target="[#portal.exe]" WorkingDirectory="INSTALLFOLDER" />
                <RegistryValue Root="HKCU" Key="Software\!(bind.Property.ProductName)" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
          </Component>
      </StandardDirectory>
  </Package>
</Wix>
